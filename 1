CREATE TABLE branch_master(
  branch_id INT PRIMARY KEY,
  branch_name VARCHAR(30)
);

CREATE TABLE employee_master(
  emp_id INT PRIMARY KEY,
  first_name VARCHAR(30),
  middle_name VARCHAR(30),
  last_name VARCHAR(30),
  department VARCHAR(30),
  manager_id INT,
  branch_id INT,
  FOREIGN KEY(branch_id) REFERENCES branch_master(branch_id)
);

-- Insert records
INSERT INTO branch_master VALUES (1, 'Pune'), (2, 'Mumbai');

INSERT INTO employee_master VALUES
(101, 'Amit', 'K', 'Sharma', 'HR', NULL, 1),
(102, 'Neha', 'R', 'Patil', 'Finance', 101, 1),
(103, 'Rohan', 'S', 'Desai', 'IT', 101, 2);

-- Create index
CREATE INDEX idx_empname ON employee_master(first_name);

-- Create view
CREATE VIEW emp_details AS
SELECT e.emp_id, CONCAT(e.first_name,' ',e.last_name) AS emp_name,
       e.department, b.branch_name
FROM employee_master e
JOIN branch_master b ON e.branch_id=b.branch_id;
